Technical Documentation for Agrolink: Enhancing Efficiency and
Transparency in Bangladesh's Vegetable Supply Chain
1. Introduction
This document provides a comprehensive guide to setting up a Hyperledger Fabric network specifically designed for
a food supply chain. The network facilitates the interactions between three key organizations: Buyer, Seller, and
Government. Each organization plays a distinct role in managing the lifecycle of transactions in the supply chain.
This documentation covers the network's architecture, configuration, chaincode deployment, and usage.
2. Network Architecture
Organizations
- Buyer: The purchasing entity within the food supply chain.
- Seller: The supplier of food products.
- Government (Gov): The regulatory authority ensuring compliance with food safety and trade regulations.
Each organization operates with one anchor peer, which is crucial for maintaining the network's consensus.
Peers
- Each organization controls one anchor peer that manages the ledger and executes smart contracts (chaincode).
Orderer
- Solo Orderer: A single-node orderer that handles the ordering service, ensuring that transactions are processed and
distributed consistently across the network.
Channel
- Channel Name: `foodsupplychainchannel`
- A dedicated channel for all the organizations to facilitate and manage transactions related to the food supply chain.
3. Prerequisites
Before proceeding with the setup, ensure the following prerequisites are fulfilled:
- Docker and Docker Compose: Both should be installed and running.
- Hyperledger Fabric Binaries: Ensure that the necessary binaries and Docker images for Hyperledger Fabric are
downloaded and accessible.
- Operating System: A Linux-based system, preferably Ubuntu, is recommended for the setup.
4. Configuration Files
The network's setup and configuration require several key files to be modified and used:
`generate-ca-config.sh`
This script generates the Certificate Authorities (CAs) required for each organization. Each CA is responsible for
managing the identity of the members within its respective organization.
Key Modifications:
- Configure CA details for each organization (Buyer, Seller, Government).
- Define paths and filenames for the certificates and keys generated by the CA.
`configtx/configtx.yaml`
This configuration file defines the overall network topology, including the organizations, consortium, and channel.
Key Modifications:
- Update organization details such as MSP IDs and anchor peers.
- Configure the channel `foodsupplychainchannel` to include the Buyer, Seller, and Government organizations.
`ccp-generate.sh`
The script generates the connection profile (CCP) for each organization. The CCP is crucial for applications to
interact with the network.
Key Modifications:
- Modify organization-specific details such as MSP ID, peer addresses, and orderer endpoints.
- Ensure the correct channel name (`foodsupplychainchannel`) is used.
`network.sh`
This primary script is responsible for setting up the network, including creating the channel, joining peers to the
channel, and launching the network.
Key Modifications:
- Include steps for creating and joining the `foodsupplychainchannel`.
- Ensure all peers, orderers, and CAs are started and configured properly.
5. Chaincode Deployment
Chaincode is the smart contract deployed on the network to automate and enforce rules and business logic. The
following scripts and files are used to manage chaincode deployment:
`deploy_01_order_place_and_letter_of_credit.sh`
This script is used to deploy the chaincode that manages the processes of placing orders and issuing letters of credit
within the food supply chain.
`deploy_food_supply_contract.sh`
Deploys the chaincode that manages the food supply contracts, ensuring the terms and conditions between Buyer
and Seller are upheld.
`deploy_transaction_contract.sh`
This script handles the deployment of the chaincode responsible for managing the transactions, recording them on
the blockchain, and validating their authenticity.
`transaction-contract`
The `transaction-contract` directory contains the chaincode logic, which includes several key files:
- `lib` Directory: Contains the core logic of the chaincode, including the functions for transaction management.
- `index.js`: The entry point for the chaincode, initializing and setting up the transaction functions.
- `package.json` and `package-lock.json`: Manage the dependencies required by the chaincode.
6. Usage
Once the network is set up and chaincode is deployed, you can perform various operations by invoking chaincode
functions.
Invoking Chaincode Functions
- Create a Transaction: Use the `invoke-createTransaction.sh` script to initiate a new transaction within the network.
- Query All Transactions: Run the `invoke-getalltransactions.sh` script to retrieve a list of all transactions recorded
on the blockchain.
- Initialize Ledger: Use the `invoke-initledger.sh` script to populate the ledger with initial data, such as predefined
transactions or assets.
7. Troubleshooting
Here are some common issues and their solutions:
- Network Setup Issues: Ensure all Docker containers are running correctly by using the `docker ps` command. If
containers are not running, check the Docker logs for errors.
- Chaincode Deployment Failures: If chaincode fails to deploy, review the peer logs for connectivity issues or syntax
errors in the chaincode.
- Transaction Errors: Ensure the correct parameters are being passed to chaincode functions and that all peers are
synchronized and updated.
This documentation provides a structured and detailed guide to setting up and managing a Hyperledger Fabric
network for a Agrolink, ensuring a smooth and efficient deployment process.
